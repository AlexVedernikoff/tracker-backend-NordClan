const config = require('../../configs').email;

module.exports = function (templateName, input){

  let subject, body;
  const i = input;

  switch (templateName){
  case ('newTaskForQAPM'):
    // input.task

    subject = `Новая задача: ${i.task.project.name} - ${i.task.id}: ${i.task.name}`;

    /*body
        = `<h2>В проект ${i.task.project.name} добавлена новая задача:<br>
        ${i.task.id}: ${i.task.name}</h2>
        ${i.task.description ? `<h3><strong>Описание задачи:</strong><br>${i.task.description}</h3>` : '' }
        <p><strong>Тип задачи</strong> : ${i.task.type.name}</p>
        <p><strong>Приоритет задачи</strong> : ${i.task.prioritiesId}</p>
        <p><strong>Задачу добавил</strong> : ${i.task.author.fullNameRu}</p>
        ${i.task.performer ? `<p><strong>Исполнитель</strong> : ${i.task.performer.fullNameRu}</p>` : '' }
        ${i.task.plannedExecutionTime ? `<p><strong>Планируемое время выполнения</strong> : ${i.task.plannedExecutionTime}</p>` : ''}
        ${i.task.sprint ? `<p><strong>Спринт</strong> : ${i.task.sprint.name}</p>` : ''}
        <a href="${config.templateBaseUrl}/projects/${i.task.project.id}/tasks/${i.task.id}" target="_blank">Перейти к задаче</a>`;*/

    /*body = `    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">    <html xmlns="http://www.w3.org/1999/xhtml">    <head>      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />      <title>${subject}</title>      <style type="text/css">      body {       padding-top: 0 !important;       padding-bottom: 0 !important;       padding-top: 0 !important;       padding-bottom: 0 !important;       margin:0 !important;       width: 100% !important;       -webkit-text-size-adjust: 100% !important;       -ms-text-size-adjust: 100% !important;       -webkit-font-smoothing: antialiased !important;     }     .tableContent img {       border: 0 !important;       display: block !important;       outline: none !important;     }     a{      color:#382F2E;    }    p, h1{      color:#382F2E;      margin:0;    } p{      text-align:left;      color:#999999;      font-size:14px;      font-weight:normal;      line-height:19px;    }    a.link1{      color:#382F2E;    }    a.link2{      font-size:16px;      text-decoration:none;      color:#ffffff;    }    h2{      text-align:left;       color:#222222;        font-size:19px;      font-weight:normal;    }    div,p,ul,h1{      margin:0;    }    .bgBody{      background: #ffffff;    }    .bgItem{      background: #ffffff;    }  @media only screen and (max-width:480px)    {   table[class="MainContainer"], td[class="cell"]  {   width: 100% !important;   height:auto !important;   }td[class="specbundle"]   {   width:100% !important;    float:left !important;    font-size:13px !important;    line-height:17px !important;    display:block !important;   padding-bottom:15px !important; }   td[class="spechide"]  {   display:none !important;  }     img[class="banner"]   {           width: 100% !important;           height: auto !important;  }   td[class="left_pad"]  {     padding-left:15px !important;     padding-right:15px !important;  }    }  @media only screen and (max-width:540px) {    table[class="MainContainer"], td[class="cell"]  {   width: 100% !important;   height:auto !important;   }td[class="specbundle"]   {   width:100% !important;    float:left !important;    font-size:13px !important;    line-height:17px !important;    display:block !important;   padding-bottom:15px !important; }   td[class="spechide"]  {   display:none !important;  }     img[class="banner"]   {           width: 100% !important;           height: auto !important;  } .font {   font-size:18px !important;    line-height:22px !important;        }   .font1 {    font-size:18px !important;    line-height:22px !important;        }}    </style><script type="colorScheme" class="swatch active">{    "name":"Default",    "bgBody":"ffffff",    "link":"382F2E",    "color":"999999",    "bgItem":"ffffff",    "title":"222222"}</script>  </head>  <body paddingwidth="0" paddingheight="0"   style="padding-top: 0; padding-bottom: 0; padding-top: 0; padding-bottom: 0; background-repeat: repeat; width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; -webkit-font-smoothing: antialiased;" offset="0" toppadding="0" leftpadding="0">    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" class="tableContent" align="center"  style='font-family:Helvetica, Arial,serif;'>  <tbody>    <tr>      <td><table width="600" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#ffffff" class="MainContainer">  <tbody>    <tr>      <td><table width="100%" border="0" cellspacing="0" cellpadding="0">  <tbody>    <tr>      <td valign="top" width="40">&nbsp;</td>      <td><table width="100%" border="0" cellspacing="0" cellpadding="0">  <tbody>  <!-- =============================== Header ====================================== -->       <tr>     <td height='75' class="spechide"></td>                <!-- =============================== Body ====================================== -->    </tr>    <tr>      <td class='movableContentContainer ' valign='top'>       <div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;">         <table width="100%" border="0" cellspacing="0" cellpadding="0">  <tbody>    <tr>      <td height="35"></td>    </tr>    <tr>      <td><table width="100%" border="0" cellspacing="0" cellpadding="0">  <tbody>    <tr>      <td valign="top" align="center" class="specbundle"><div class="contentEditableContainer contentTextEditable">                                <div class="contentEditable">                                  <p style='text-align:right;margin:0;font-family:Georgia,Time,sans-serif;font-size:26px;color:#222222;'><img style="display: inline!important;padding-right: 5px;margin-top: -9px; margin-left: -52px; margin-bottom: -9px;" src="data:image/png;base64,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" width='38' height='36' alt='simtrack logo' data-default="placeholder" data-max-width="52" data-customIcon="true"><span class="specbundle2"><span class="font1">Новая задача в &nbsp;</span></span></p>                                </div>                              </div></td>      <td valign="top" class="specbundle"><div class="contentEditableContainer contentTextEditable" style="text-align:left;">                                <div class="contentEditable">                                  <a href="${config.templateBaseUrl}/projects/${i.task.project.id}" style='text-align:left;margin:0;font-family:Georgia,Time,sans-serif;font-size:26px;color:#ff7800; line-height: 19px;'><span class="font">${i.task.project.name}</span> </a>                                </div>                              </div></td>    </tr>  </tbody></table></td>    </tr>  </tbody></table>        </div>        <div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;">         <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">                          <tr><td height='55'></td></tr>                          <tr>                            <td align='left'>                              <div class="contentEditableContainer contentTextEditable">                                <div class="contentEditable" align='center'>                                  <h2 ><a href="${config.templateBaseUrl}/projects/${i.task.project.id}/tasks/${i.task.id}" target="_blank" style='text-align:left;margin:0;font-family:Georgia,Time,sans-serif;font-size:26px; line-height: 25px;'><span class="font">${i.task.type.name}. ${i.task.id}: ${i.task.name}</a></h2>                                </div>                              </div>                            </td>                          </tr>                          <tr><td height='15'></td></tr>                          <tr>                            <td align='left'>                              <div class="contentEditableContainer contentTextEditable">                                <div class="contentEditable" align='center'>                                  <p >                                    ${i.task.description}                                  </p>                                </div>                              </div>                            </td>                          </tr>              <tr><td height='20'></td></tr>              <tr>                            <td align='left'>                              <div class="contentEditableContainer contentTextEditable">                                <div class="contentEditable" align='center'>                                  <p >                                    <b>Спринт:</b>` +
    + ( i.task.sprint ? i.task.sprint.name : '') +
    `                                  </p>                 <p >                                    <b>Приоритет:</b> ${i.task.prioritiesId}                                  </p>                  <p >                                    <b>Автор:</b> ${i.task.author.fullNameRu}                                  </p>                                </div>                              </div>                            </td>                          </tr>                                                    <!--tr>                            <td align='center'>                              <table>                                <tr>                                  <td align='center' bgcolor='#1A54BA' style='background:#ff7800; padding:15px 18px;-webkit-border-radius: 4px; -moz-border-radius: 4px; border-radius: 4px;'>                                    <div class="contentEditableContainer contentTextEditable">                                      <div class="contentEditable" align='center'>                                        <a target='_blank' href='${config.templateBaseUrl}/projects/${i.task.project.id}/tasks/${i.task.id}' class='link2' style='color:#ffffff;'>Перейти к задаче</a>                                      </div>                                    </div>                                  </td>                                </tr>                              </table>                            </td>                          </tr-->                          <tr><td height='20'></td></tr>                        </table>        </div>        <div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;">         <table width="100%" border="0" cellspacing="0" cellpadding="0">  <tbody>    <tr>      <td height='65'>    </tr>    <tr>      <td  style='border-bottom:1px solid #DDDDDD;'></td>    </tr>    <tr><td height='25'></td></tr>    <tr>      <td><table width="100%" border="0" cellspacing="0" cellpadding="0">  <tbody>    <tr>      <td valign="top" class="specbundle"><div class="contentEditableContainer contentTextEditable">                                      <div class="contentEditable" align='center'>                                        <p  style='text-align:left;color:#CCCCCC;font-size:12px;font-weight:normal;line-height:20px;'>                                          <span style='font-weight:bold;'>SimbirSoft</span>                                          <br>                                          Это письмо отправлено из <a href="#">SimTrack</a>                                          <!--br>                                          <a target='_blank' href="[FORWARD]">Forward to a friend</a><br>                                          <a target="_blank" class='link1' class='color:#382F2E;' href="[UNSUBSCRIBE]">Unsubscribe</a>                                          <br>                                          <a target='_blank' class='link1' class='color:#382F2E;' href="[SHOWEMAIL]">Show this email in your browser</a>                                        </p>                                      </div>                                    </div></td>      <td valign="top" width="30" class="specbundle">&nbsp;</td>      <td valign="top" class="specbundle"><table width="100%" border="0" cellspacing="0" cellpadding="0">          <!--  <tbody>    <tr>      <td valign='top' width='52'>                                    <div class="contentEditableContainer contentFacebookEditable">                                      <div class="contentEditable">                                        <a target='_blank' href="#"><img src="images/facebook.png" width='52' height='53' alt='facebook icon' data-default="placeholder" data-max-width="52" data-customIcon="true"></a>                                      </div>                                    </div>                                  </td>      <td valign="top" width="16">&nbsp;</td>      <td valign='top' width='52'>                                    <div class="contentEditableContainer contentTwitterEditable">                                      <div class="contentEditable">                                        <a target='_blank' href="#"><img src="images/twitter.png" width='52' height='53' alt='twitter icon' data-default="placeholder" data-max-width="52" data-customIcon="true"></a>                                      </div>                                    </div>                                  </td>    </tr>  </tbody> --></table></td>    </tr>  </tbody></table></td>    </tr>    <tr><td height='88'></td></tr>  </tbody></table>        </div>                <!-- =============================== footer ====================================== -->            </td>    </tr>  </tbody></table></td>      <td valign="top" width="40">&nbsp;</td>    </tr>  </tbody></table></td>    </tr>  </tbody></table></td>    </tr>  </tbody></table>    </body></html>`;*/

    body = `<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html xmlns="http://www.w3.org/1999/xhtml">  <head>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />    <title>[SUBJECT]</title>  </head>  <body>    <table border="0" cellpadding="0" cellspacing="0" style="margin:0; padding:0;table-layout: fixed;width: 600px;color: #2d4154;font-size: 14px;">      <tr>        <td>          <span style="font-size: 13px;">            Новая задача в            <a href="#" style="font-weight: bold; font-style: italic; color: #2d4154; line-height: 19px;" target="_blank">              ${i.task.project.name}            </a>          </span>        </td>      </tr>      <tr>        <td style="padding: 10px;"></td>      </tr>      <tr>        <a href="#" style="font-weight: bold; font-style: italic; color: #2d4154; line-height: 25px;" target="_blank">          ${i.task.type.name}. ${i.task.id}: ${i.task.name}        </a>      </tr>      <tr>        <td style="padding: 10px;"></td>      </tr>      <tr>        <td>          <span style="font-weight: normal;line-height: 19px;">            ${i.task.description}          </span>        </td>      </tr>      <tr>        <td style="padding: 10px;"></td>      </tr>      <tr>        <td style="font-weight: normal;line-height: 19px;">          <span style="font-weight: bold; font-style: italic;">Спринт:</span>          {i.task.sprint.name}          <br>          <span style="font-weight: bold; font-style: italic;">Приоритет:</span>          ${i.task.prioritiesId}          <br>          <span style="font-weight: bold; font-style: italic;">Автор:</span>          ${i.task.author.fullNameRu}        </td>      </tr>      <tr>        <td style="padding: 10px; border-bottom:1px solid #DDDDDD;"></td>      </tr>      <tr>        <td style="padding: 10px;"></td>      </tr>      <tr>        <td style="font-weight: normal;line-height: 19px; color: #999999; font-size: 12px;">          <span style="font-weight: bold; font-style: italic;">SimbirSoft</span>          <br>          Это письмо отправлено из          <a href="#" style="color: #999999;" target="_blank">            SimTrack          </a>        </td>      </tr>    </table>  </body></html>`;

    break;

  case ('newTaskForPerformer'):
    subject = `Вам назначена новая задача: ${i.task.project.name} - ${i.task.id}: ${i.task.name}`;

    body
        = `<h2>Вам назначена новая задача:<br>
        ${i.task.id}: ${i.task.name}</h2>
        ${i.task.description ? `<h3><strong>Описание задачи:</strong><br>${i.task.description}</h3>` : '' }
        <p><strong>Тип задачи</strong> : ${i.task.type.name}</p>
        <p><strong>Приоритет задачи</strong> : ${i.task.prioritiesId}</p>
        ${i.task.plannedExecutionTime ? `<p><strong>Планируемое время выполнения</strong> : ${i.task.plannedExecutionTime}</p>` : ''}
        <a href="${config.templateBaseUrl}/projects/${i.task.project.id}/tasks/${i.task.id}" target="_blank">Перейти к задаче</a>`;

    break;

  case ('newTaskComment'):
    subject = `Новый комментарий к задаче ${i.task.project.name} - ${i.task.id}: ${i.task.name}`;

    body
        = `<h2>${i.comment.author.fullNameRu} оставил(-а) комментарий к задаче<br>
        ${i.task.id}: ${i.task.name}</h2>
        <p>${i.comment.text}</p>
        <a href="${config.templateBaseUrl}/projects/${i.task.project.id}/tasks/${i.task.id}" target="_blank">Перейти к задаче</a>`;

    break;

  case ('taskStatusChange'):
    subject = `Изменение статуса задачи: ${i.task.project.name} - ${i.task.id}: ${i.task.name}`;

    body
        = `<h2>Задача ${i.task.id}: ${i.task.name} переведена в статус<br>
        ${i.task.taskStatus.name}</h2>
        <a href="${config.templateBaseUrl}/projects/${i.task.project.id}/tasks/${i.task.id}" target="_blank">Перейти к задаче</a>`;

    break;

  case ('newTaskCommentMention'):
    break;

  default:
    throw new Error('template not found');
  }

  return {
    subject,
    body
  };

};
